{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.9.0", "generated_at": "2025-11-26T20:17:52.058755Z", "invocation_id": "e6331f6d-db65-4f21-9441-416357a6e00e", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-26T20:17:51.566227Z", "completed_at": "2025-11-26T20:17:51.597145Z"}, {"name": "execute", "started_at": "2025-11-26T20:17:51.599164Z", "completed_at": "2025-11-26T20:17:51.599210Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.04254150390625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_ecommerce.d_tiempo", "compiled": true, "compiled_code": "with fechas as (\r\n\r\n    select\r\n        generate_series(\r\n            date '2020-01-01',\r\n            date '2025-12-31',\r\n            interval '1 day'\r\n        )::date as fecha\r\n\r\n),\r\n\r\ndim as (\r\n\r\n    select\r\n        fecha,\r\n        extract(year from fecha)::int    as anio,\r\n        extract(month from fecha)::int   as mes,\r\n        to_char(fecha, 'TMMonth')        as nombre_mes,\r\n        extract(quarter from fecha)::int as trimestre,\r\n        extract(dow from fecha)::int     as dia_semana,\r\n        to_char(fecha, 'TMDay')          as nombre_dia_semana\r\n    from fechas\r\n\r\n),\r\n\r\ncon_clave as (\r\n\r\n    select\r\n        row_number() over (order by fecha) as tiempo_key,\r\n        fecha,\r\n        anio,\r\n        mes,\r\n        nombre_mes,\r\n        trimestre,\r\n        dia_semana,\r\n        nombre_dia_semana\r\n    from dim\r\n\r\n)\r\n\r\nselect\r\n    tiempo_key,\r\n    fecha,\r\n    anio,\r\n    mes,\r\n    nombre_mes,\r\n    trimestre,\r\n    dia_semana,\r\n    nombre_dia_semana\r\nfrom con_clave", "relation_name": "\"EcommerceDB\".\"dbt_marts\".\"d_tiempo\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-26T20:17:51.579569Z", "completed_at": "2025-11-26T20:17:51.615782Z"}, {"name": "execute", "started_at": "2025-11-26T20:17:51.619903Z", "completed_at": "2025-11-26T20:17:51.619930Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.060842037200927734, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_ecommerce.stg_categorias", "compiled": true, "compiled_code": "with fuente as (\n\n    select\n        categoria_id,\n        nombre,\n        descripcion\n    from \"EcommerceDB\".\"public\".\"categorias\"\n\n)\n\nselect\n    categoria_id,\n    nombre,\n    descripcion\nfrom fuente", "relation_name": "\"EcommerceDB\".\"dbt_staging\".\"stg_categorias\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-26T20:17:51.575294Z", "completed_at": "2025-11-26T20:17:51.616982Z"}, {"name": "execute", "started_at": "2025-11-26T20:17:51.623078Z", "completed_at": "2025-11-26T20:17:51.623103Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.06509995460510254, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_ecommerce.stg_carrito", "compiled": true, "compiled_code": "with fuente as (\n\n    select\n        carrito_id,\n        usuario_id,\n        producto_id,\n        cantidad,\n        fecha_agregado\n    from \"EcommerceDB\".\"public\".\"carrito\"\n\n)\n\nselect\n    carrito_id,\n    usuario_id,\n    producto_id,\n    cantidad,\n    fecha_agregado\nfrom fuente", "relation_name": "\"EcommerceDB\".\"dbt_staging\".\"stg_carrito\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-26T20:17:51.583720Z", "completed_at": "2025-11-26T20:17:51.617935Z"}, {"name": "execute", "started_at": "2025-11-26T20:17:51.625401Z", "completed_at": "2025-11-26T20:17:51.625455Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.06507563591003418, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_ecommerce.stg_detalle_ordenes", "compiled": true, "compiled_code": "with fuente as (\n\n    select\n        detalle_id,\n        orden_id,\n        producto_id,\n        cantidad,\n        precio_unitario\n    from \"EcommerceDB\".\"public\".\"detalle_ordenes\"\n\n)\n\nselect\n    detalle_id,\n    orden_id,\n    producto_id,\n    cantidad,\n    precio_unitario\nfrom fuente", "relation_name": "\"EcommerceDB\".\"dbt_staging\".\"stg_detalle_ordenes\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-26T20:17:51.606317Z", "completed_at": "2025-11-26T20:17:51.647756Z"}, {"name": "execute", "started_at": "2025-11-26T20:17:51.659947Z", "completed_at": "2025-11-26T20:17:51.659963Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.056754112243652344, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_ecommerce.stg_direcciones_envio", "compiled": true, "compiled_code": "with fuente as (\n\n    select\n        direccion_id,\n        usuario_id,\n        calle,\n        ciudad,\n        departamento,\n        provincia,\n        distrito,\n        estado,\n        codigo_postal,\n        pais\n    from \"EcommerceDB\".\"public\".\"direcciones_envio\"\n\n)\n\nselect\n    direccion_id,\n    usuario_id,\n    calle,\n    ciudad,\n    departamento,\n    provincia,\n    distrito,\n    estado,\n    codigo_postal,\n    pais\nfrom fuente", "relation_name": "\"EcommerceDB\".\"dbt_staging\".\"stg_direcciones_envio\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-26T20:17:51.654671Z", "completed_at": "2025-11-26T20:17:51.682314Z"}, {"name": "execute", "started_at": "2025-11-26T20:17:51.691019Z", "completed_at": "2025-11-26T20:17:51.691042Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.054711103439331055, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_ecommerce.stg_ordenes", "compiled": true, "compiled_code": "with fuente as (\n\n    select\n        orden_id,\n        usuario_id,\n        fecha_orden,\n        total,\n        estado\n    from \"EcommerceDB\".\"public\".\"ordenes\"\n\n)\n\nselect\n    orden_id,\n    usuario_id,\n    fecha_orden,\n    total,\n    estado\nfrom fuente", "relation_name": "\"EcommerceDB\".\"dbt_staging\".\"stg_ordenes\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-26T20:17:51.642971Z", "completed_at": "2025-11-26T20:17:51.683628Z"}, {"name": "execute", "started_at": "2025-11-26T20:17:51.693550Z", "completed_at": "2025-11-26T20:17:51.693572Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.06080317497253418, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_ecommerce.stg_historial_pagos", "compiled": true, "compiled_code": "with fuente as (\n\n    select\n        historial_pago_id,\n        orden_id,\n        metodo_pago_id,\n        monto,\n        fecha_pago,\n        estado_pago\n    from \"EcommerceDB\".\"public\".\"historial_pagos\"\n\n)\n\nselect\n    historial_pago_id,\n    orden_id,\n    metodo_pago_id,\n    monto,\n    fecha_pago,\n    estado_pago\nfrom fuente", "relation_name": "\"EcommerceDB\".\"dbt_staging\".\"stg_historial_pagos\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-26T20:17:51.648706Z", "completed_at": "2025-11-26T20:17:51.689529Z"}, {"name": "execute", "started_at": "2025-11-26T20:17:51.696000Z", "completed_at": "2025-11-26T20:17:51.696019Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.06146502494812012, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_ecommerce.stg_metodos_pago", "compiled": true, "compiled_code": "with fuente as (\n\n    select\n        metodo_pago_id,\n        nombre,\n        descripcion\n    from \"EcommerceDB\".\"public\".\"metodos_pago\"\n\n)\n\nselect\n    metodo_pago_id,\n    nombre,\n    descripcion\nfrom fuente", "relation_name": "\"EcommerceDB\".\"dbt_staging\".\"stg_metodos_pago\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-26T20:17:51.668576Z", "completed_at": "2025-11-26T20:17:51.709991Z"}, {"name": "execute", "started_at": "2025-11-26T20:17:51.716058Z", "completed_at": "2025-11-26T20:17:51.716073Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.05095934867858887, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_ecommerce.stg_ordenes_metodospago", "compiled": true, "compiled_code": "with fuente as (\n\n    select\n        orden_metodo_pago_id,\n        orden_id,\n        metodo_pago_id,\n        monto_pagado\n    from \"EcommerceDB\".\"public\".\"ordenes_metodospago\"\n\n)\n\nselect\n    orden_metodo_pago_id,\n    orden_id,\n    metodo_pago_id,\n    monto_pagado\nfrom fuente", "relation_name": "\"EcommerceDB\".\"dbt_staging\".\"stg_ordenes_metodospago\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-26T20:17:51.734254Z", "completed_at": "2025-11-26T20:17:51.763037Z"}, {"name": "execute", "started_at": "2025-11-26T20:17:51.767639Z", "completed_at": "2025-11-26T20:17:51.767661Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.05341649055480957, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_ecommerce.stg_usuarios", "compiled": true, "compiled_code": "with fuente as (\n\n    select\n        usuario_id,\n        nombre,\n        apellido,\n        dni,\n        email,\n        contrasena\n    from \"EcommerceDB\".\"public\".\"usuarios\"\n\n)\n\nselect\n    usuario_id,\n    nombre,\n    apellido,\n    dni,\n    email,\n    contrasena\nfrom fuente", "relation_name": "\"EcommerceDB\".\"dbt_staging\".\"stg_usuarios\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-26T20:17:51.730541Z", "completed_at": "2025-11-26T20:17:51.764499Z"}, {"name": "execute", "started_at": "2025-11-26T20:17:51.770487Z", "completed_at": "2025-11-26T20:17:51.770507Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.057630300521850586, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_ecommerce.stg_resenas_productos", "compiled": true, "compiled_code": "with fuente as (\n\n    select\n        resena_id,\n        usuario_id,\n        producto_id,\n        calificacion,\n        comentario,\n        fecha\n    from \"EcommerceDB\".\"public\".\"resenas_productos\"\n\n)\n\nselect\n    resena_id,\n    usuario_id,\n    producto_id,\n    calificacion,\n    comentario,\n    fecha\nfrom fuente", "relation_name": "\"EcommerceDB\".\"dbt_staging\".\"stg_resenas_productos\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-26T20:17:51.723090Z", "completed_at": "2025-11-26T20:17:51.766090Z"}, {"name": "execute", "started_at": "2025-11-26T20:17:51.773003Z", "completed_at": "2025-11-26T20:17:51.773024Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.06170535087585449, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_ecommerce.stg_productos", "compiled": true, "compiled_code": "with fuente as (\n\n    select\n        producto_id,\n        nombre,\n        descripcion,\n        precio,\n        stock,\n        categoria_id\n    from \"EcommerceDB\".\"public\".\"productos\"\n\n)\n\nselect\n    producto_id,\n    nombre,\n    descripcion,\n    precio,\n    stock,\n    categoria_id\nfrom fuente", "relation_name": "\"EcommerceDB\".\"dbt_staging\".\"stg_productos\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-26T20:17:51.743962Z", "completed_at": "2025-11-26T20:17:51.779095Z"}, {"name": "execute", "started_at": "2025-11-26T20:17:51.785907Z", "completed_at": "2025-11-26T20:17:51.785933Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.04709672927856445, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_ecommerce.d_categoria", "compiled": true, "compiled_code": "with base as (\n\n    select distinct\n        categoria_id,\n        nombre,\n        descripcion\n    from \"EcommerceDB\".\"dbt_staging\".\"stg_categorias\"\n\n),\n\ncon_clave as (\n\n    select\n        row_number() over (order by categoria_id) as categoria_key,\n        categoria_id,\n        nombre        as nombre_categoria,\n        descripcion   as descripcion_categoria\n    from base\n\n)\n\nselect\n    categoria_key,\n    categoria_id,\n    nombre_categoria,\n    descripcion_categoria\nfrom con_clave", "relation_name": "\"EcommerceDB\".\"dbt_marts\".\"d_categoria\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-26T20:17:51.799593Z", "completed_at": "2025-11-26T20:17:51.838843Z"}, {"name": "execute", "started_at": "2025-11-26T20:17:51.842789Z", "completed_at": "2025-11-26T20:17:51.842818Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.05924630165100098, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_ecommerce.d_estado_orden", "compiled": true, "compiled_code": "with base as (\n\n    select distinct\n        estado\n    from \"EcommerceDB\".\"dbt_staging\".\"stg_ordenes\"\n    where estado is not null\n\n),\n\ncon_clave as (\n\n    select\n        row_number() over (order by estado) as estado_orden_key,\n        estado as codigo_estado_orden,\n        estado as descripcion_estado_orden\n    from base\n\n)\n\nselect\n    estado_orden_key,\n    codigo_estado_orden,\n    descripcion_estado_orden\nfrom con_clave", "relation_name": "\"EcommerceDB\".\"dbt_marts\".\"d_estado_orden\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-26T20:17:51.806251Z", "completed_at": "2025-11-26T20:17:51.840165Z"}, {"name": "execute", "started_at": "2025-11-26T20:17:51.846739Z", "completed_at": "2025-11-26T20:17:51.846765Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.05891919136047363, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_ecommerce.d_estado_pago", "compiled": true, "compiled_code": "with base as (\n\n    select distinct\n        estado_pago\n    from \"EcommerceDB\".\"dbt_staging\".\"stg_historial_pagos\"\n    where estado_pago is not null\n\n),\n\ncon_clave as (\n\n    select\n        row_number() over (order by estado_pago) as estado_pago_key,\n        estado_pago as codigo_estado_pago,\n        estado_pago as descripcion_estado_pago\n    from base\n\n)\n\nselect\n    estado_pago_key,\n    codigo_estado_pago,\n    descripcion_estado_pago\nfrom con_clave", "relation_name": "\"EcommerceDB\".\"dbt_marts\".\"d_estado_pago\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-26T20:17:51.795296Z", "completed_at": "2025-11-26T20:17:51.841219Z"}, {"name": "execute", "started_at": "2025-11-26T20:17:51.850856Z", "completed_at": "2025-11-26T20:17:51.850880Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.06870770454406738, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_ecommerce.d_direccion_envio", "compiled": true, "compiled_code": "with base as (\n\n    select distinct\n        direccion_id,\n        usuario_id,\n        calle,\n        ciudad,\n        departamento,\n        provincia,\n        distrito,\n        estado,\n        codigo_postal,\n        pais\n    from \"EcommerceDB\".\"dbt_staging\".\"stg_direcciones_envio\"\n\n),\n\ncon_clave as (\n\n    select\n        row_number() over (order by direccion_id) as direccion_key,\n        direccion_id,\n        usuario_id,\n        calle,\n        ciudad,\n        departamento,\n        provincia,\n        distrito,\n        estado,\n        codigo_postal,\n        pais\n    from base\n\n)\n\nselect\n    direccion_key,\n    direccion_id,\n    usuario_id,\n    calle,\n    ciudad,\n    departamento,\n    provincia,\n    distrito,\n    estado,\n    codigo_postal,\n    pais\nfrom con_clave", "relation_name": "\"EcommerceDB\".\"dbt_marts\".\"d_direccion_envio\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-26T20:17:51.814018Z", "completed_at": "2025-11-26T20:17:51.852706Z"}, {"name": "execute", "started_at": "2025-11-26T20:17:51.859216Z", "completed_at": "2025-11-26T20:17:51.859237Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.05454230308532715, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_ecommerce.d_metodo_pago", "compiled": true, "compiled_code": "with base as (\n\n    select distinct\n        metodo_pago_id,\n        nombre,\n        descripcion\n    from \"EcommerceDB\".\"dbt_staging\".\"stg_metodos_pago\"\n\n),\n\ncon_clave as (\n\n    select\n        row_number() over (order by metodo_pago_id) as metodo_pago_key,\n        metodo_pago_id,\n        nombre       as nombre_metodo_pago,\n        descripcion  as descripcion_metodo_pago\n    from base\n\n)\n\nselect\n    metodo_pago_key,\n    metodo_pago_id,\n    nombre_metodo_pago,\n    descripcion_metodo_pago\nfrom con_clave", "relation_name": "\"EcommerceDB\".\"dbt_marts\".\"d_metodo_pago\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-26T20:17:51.871623Z", "completed_at": "2025-11-26T20:17:51.907280Z"}, {"name": "execute", "started_at": "2025-11-26T20:17:51.911692Z", "completed_at": "2025-11-26T20:17:51.911712Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.05059242248535156, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_ecommerce.d_usuario", "compiled": true, "compiled_code": "with base as (\n\n    select\n        usuario_id,\n        nombre,\n        apellido,\n        dni,\n        email,\n        contrasena\n    from \"EcommerceDB\".\"dbt_staging\".\"stg_usuarios\"\n\n),\n\ncon_clave as (\n\n    select\n        row_number() over (order by usuario_id) as usuario_key,\n        usuario_id,\n        nombre,\n        apellido,\n        dni,\n        email,\n        contrasena\n    from base\n\n)\n\nselect\n    usuario_key,\n    usuario_id,\n    nombre,\n    apellido,\n    dni,\n    email,\n    contrasena\nfrom con_clave", "relation_name": "\"EcommerceDB\".\"dbt_marts\".\"d_usuario\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-26T20:17:51.880110Z", "completed_at": "2025-11-26T20:17:51.908734Z"}, {"name": "execute", "started_at": "2025-11-26T20:17:51.914389Z", "completed_at": "2025-11-26T20:17:51.914409Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.04925227165222168, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_ecommerce.d_producto", "compiled": true, "compiled_code": "with productos as (\n\n    select\n        producto_id,\n        nombre,\n        descripcion,\n        precio,\n        stock,\n        categoria_id\n    from \"EcommerceDB\".\"dbt_staging\".\"stg_productos\"\n\n),\n\ncategorias as (\n\n    select\n        categoria_key,\n        categoria_id\n    from \"EcommerceDB\".\"dbt_marts\".\"d_categoria\"\n\n),\n\njoined as (\n\n    select\n        p.producto_id,\n        p.nombre,\n        p.descripcion,\n        p.precio,\n        p.stock,\n        p.categoria_id,\n        c.categoria_key\n    from productos p\n    left join categorias c\n        on p.categoria_id = c.categoria_id\n\n),\n\ncon_clave as (\n\n    select\n        row_number() over (order by producto_id) as producto_key,\n        producto_id,\n        nombre        as nombre_producto,\n        descripcion   as descripcion_producto,\n        precio,\n        stock,\n        categoria_key,\n        categoria_id\n    from joined\n\n)\n\nselect\n    producto_key,\n    producto_id,\n    nombre_producto,\n    descripcion_producto,\n    precio,\n    stock,\n    categoria_key,\n    categoria_id\nfrom con_clave", "relation_name": "\"EcommerceDB\".\"dbt_marts\".\"d_producto\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-26T20:17:51.875520Z", "completed_at": "2025-11-26T20:17:51.910594Z"}, {"name": "execute", "started_at": "2025-11-26T20:17:51.916708Z", "completed_at": "2025-11-26T20:17:51.916730Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.05412435531616211, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_ecommerce.int_detalle_ordenes_enriquecido", "compiled": true, "compiled_code": "with detalle as (\n\n    select\n        d.detalle_id,\n        d.orden_id,\n        d.producto_id,\n        d.cantidad,\n        d.precio_unitario,\n        d.cantidad * d.precio_unitario as importe_linea\n    from \"EcommerceDB\".\"dbt_staging\".\"stg_detalle_ordenes\" as d\n\n),\n\nordenes as (\n\n    select\n        o.orden_id,\n        o.usuario_id,\n        o.fecha_orden,\n        o.total,\n        o.estado\n    from \"EcommerceDB\".\"dbt_staging\".\"stg_ordenes\" as o\n\n),\n\nproductos as (\n\n    select\n        p.producto_id,\n        p.categoria_id\n    from \"EcommerceDB\".\"dbt_staging\".\"stg_productos\" as p\n\n)\n\nselect\n    det.detalle_id,\n    det.orden_id,\n    ord.usuario_id,\n    det.producto_id,\n    prod.categoria_id,\n    ord.fecha_orden,\n    ord.estado as estado_orden,\n    det.cantidad,\n    det.precio_unitario,\n    det.importe_linea,\n    ord.total as total_orden\nfrom detalle det\nleft join ordenes ord\n    on det.orden_id = ord.orden_id\nleft join productos prod\n    on det.producto_id = prod.producto_id", "relation_name": "\"EcommerceDB\".\"dbt_interm\".\"int_detalle_ordenes_enriquecido\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-26T20:17:51.942356Z", "completed_at": "2025-11-26T20:17:51.983061Z"}, {"name": "execute", "started_at": "2025-11-26T20:17:51.987803Z", "completed_at": "2025-11-26T20:17:51.987826Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.061104774475097656, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_ecommerce.f_pagos", "compiled": true, "compiled_code": "with pagos as (\n\n    select\n        historial_pago_id,\n        orden_id,\n        metodo_pago_id,\n        monto,\n        fecha_pago,\n        estado_pago\n    from \"EcommerceDB\".\"dbt_staging\".\"stg_historial_pagos\"\n\n),\n\nordenes as (\n\n    select\n        orden_id,\n        usuario_id\n    from \"EcommerceDB\".\"dbt_staging\".\"stg_ordenes\"\n\n),\n\nusuarios_dim as (\n\n    select\n        usuario_key,\n        usuario_id\n    from \"EcommerceDB\".\"dbt_marts\".\"d_usuario\"\n\n),\n\nmetodos_dim as (\n\n    select\n        metodo_pago_key,\n        metodo_pago_id\n    from \"EcommerceDB\".\"dbt_marts\".\"d_metodo_pago\"\n\n),\n\nestado_dim as (\n\n    select\n        estado_pago_key,\n        codigo_estado_pago\n    from \"EcommerceDB\".\"dbt_marts\".\"d_estado_pago\"\n\n),\n\ntiempo_dim as (\n\n    select\n        tiempo_key,\n        fecha\n    from \"EcommerceDB\".\"dbt_marts\".\"d_tiempo\"\n\n),\n\njoined as (\n\n    select\n        p.historial_pago_id,\n        p.orden_id,\n        u.usuario_key,\n        m.metodo_pago_key,\n        e.estado_pago_key,\n        t.tiempo_key,\n        p.monto as monto_pago\n    from pagos p\n    left join ordenes o\n        on p.orden_id = o.orden_id\n    left join usuarios_dim u\n        on o.usuario_id = u.usuario_id\n    left join metodos_dim m\n        on p.metodo_pago_id = m.metodo_pago_id\n    left join estado_dim e\n        on p.estado_pago = e.codigo_estado_pago\n    left join tiempo_dim t\n        on date(p.fecha_pago) = t.fecha\n\n),\n\ncon_clave as (\n\n    select\n        row_number() over (order by historial_pago_id) as pago_key,\n        orden_id,\n        usuario_key,\n        metodo_pago_key,\n        estado_pago_key,\n        tiempo_key,\n        monto_pago\n    from joined\n\n)\n\nselect\n    pago_key,\n    orden_id,\n    usuario_key,\n    metodo_pago_key,\n    estado_pago_key,\n    tiempo_key,\n    monto_pago\nfrom con_clave", "relation_name": "\"EcommerceDB\".\"dbt_marts\".\"f_pagos\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-26T20:17:51.948397Z", "completed_at": "2025-11-26T20:17:51.984464Z"}, {"name": "execute", "started_at": "2025-11-26T20:17:51.992305Z", "completed_at": "2025-11-26T20:17:51.992333Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.06416487693786621, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_ecommerce.f_carrito", "compiled": true, "compiled_code": "with carrito as (\n\n    select\n        carrito_id,\n        usuario_id,\n        producto_id,\n        cantidad,\n        fecha_agregado\n    from \"EcommerceDB\".\"dbt_staging\".\"stg_carrito\"\n\n),\n\nusuarios_dim as (\n\n    select\n        usuario_key,\n        usuario_id\n    from \"EcommerceDB\".\"dbt_marts\".\"d_usuario\"\n\n),\n\nproductos_dim as (\n\n    select\n        producto_key,\n        producto_id,\n        categoria_key\n    from \"EcommerceDB\".\"dbt_marts\".\"d_producto\"\n\n),\n\ntiempo_dim as (\n\n    select\n        tiempo_key,\n        fecha\n    from \"EcommerceDB\".\"dbt_marts\".\"d_tiempo\"\n\n),\n\njoined as (\n\n    select\n        c.carrito_id,\n        u.usuario_key,\n        p.producto_key,\n        p.categoria_key,\n        t.tiempo_key,\n        c.cantidad\n    from carrito c\n    left join usuarios_dim u\n        on c.usuario_id = u.usuario_id\n    left join productos_dim p\n        on c.producto_id = p.producto_id\n    left join tiempo_dim t\n        on date(c.fecha_agregado) = t.fecha\n\n),\n\ncon_clave as (\n\n    select\n        row_number() over (order by carrito_id) as carrito_key,\n        usuario_key,\n        producto_key,\n        categoria_key,\n        tiempo_key,\n        cantidad\n    from joined\n\n)\n\nselect\n    carrito_key,\n    usuario_key,\n    producto_key,\n    categoria_key,\n    tiempo_key,\n    cantidad\nfrom con_clave", "relation_name": "\"EcommerceDB\".\"dbt_marts\".\"f_carrito\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-26T20:17:51.955694Z", "completed_at": "2025-11-26T20:17:51.985426Z"}, {"name": "execute", "started_at": "2025-11-26T20:17:51.995093Z", "completed_at": "2025-11-26T20:17:51.995114Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.06604862213134766, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_ecommerce.f_resenas_productos", "compiled": true, "compiled_code": "with resenas as (\n\n    select\n        resena_id,\n        usuario_id,\n        producto_id,\n        calificacion,\n        comentario,\n        fecha\n    from \"EcommerceDB\".\"dbt_staging\".\"stg_resenas_productos\"\n\n),\n\nusuarios_dim as (\n\n    select\n        usuario_key,\n        usuario_id\n    from \"EcommerceDB\".\"dbt_marts\".\"d_usuario\"\n\n),\n\nproductos_dim as (\n\n    select\n        producto_key,\n        producto_id,\n        categoria_key\n    from \"EcommerceDB\".\"dbt_marts\".\"d_producto\"\n\n),\n\ntiempo_dim as (\n\n    select\n        tiempo_key,\n        fecha\n    from \"EcommerceDB\".\"dbt_marts\".\"d_tiempo\"\n\n),\n\njoined as (\n\n    select\n        r.resena_id,\n        u.usuario_key,\n        p.producto_key,\n        p.categoria_key,\n        t.tiempo_key,\n        r.calificacion\n    from resenas r\n    left join usuarios_dim u\n        on r.usuario_id = u.usuario_id\n    left join productos_dim p\n        on r.producto_id = p.producto_id\n    left join tiempo_dim t\n        on date(r.fecha) = t.fecha\n\n),\n\ncon_clave as (\n\n    select\n        row_number() over (order by resena_id) as resena_key,\n        usuario_key,\n        producto_key,\n        categoria_key,\n        tiempo_key,\n        calificacion\n    from joined\n\n)\n\nselect\n    resena_key,\n    usuario_key,\n    producto_key,\n    categoria_key,\n    tiempo_key,\n    calificacion\nfrom con_clave", "relation_name": "\"EcommerceDB\".\"dbt_marts\".\"f_resenas_productos\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-26T20:17:51.935109Z", "completed_at": "2025-11-26T20:17:51.993587Z"}, {"name": "execute", "started_at": "2025-11-26T20:17:52.002896Z", "completed_at": "2025-11-26T20:17:52.002922Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.07746529579162598, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_ecommerce.f_ordenes", "compiled": true, "compiled_code": "with ordenes as (\n\n    select\n        orden_id,\n        usuario_id,\n        fecha_orden,\n        total,\n        estado\n    from \"EcommerceDB\".\"dbt_staging\".\"stg_ordenes\"\n\n),\n\nusuarios_dim as (\n\n    select\n        usuario_key,\n        usuario_id\n    from \"EcommerceDB\".\"dbt_marts\".\"d_usuario\"\n\n),\n\ntiempo_dim as (\n\n    select\n        tiempo_key,\n        fecha\n    from \"EcommerceDB\".\"dbt_marts\".\"d_tiempo\"\n\n),\n\nestado_dim as (\n\n    select\n        estado_orden_key,\n        codigo_estado_orden\n    from \"EcommerceDB\".\"dbt_marts\".\"d_estado_orden\"\n\n),\n\ndireccion_dim as (\n\n    select\n        usuario_id,\n        min(direccion_key) as direccion_key\n    from \"EcommerceDB\".\"dbt_marts\".\"d_direccion_envio\"\n    group by usuario_id\n\n),\n\ndetalle_agg as (\n\n    select\n        orden_id,\n        sum(cantidad) as cantidad_productos\n    from \"EcommerceDB\".\"dbt_staging\".\"stg_detalle_ordenes\"\n    group by orden_id\n\n),\n\njoined as (\n\n    select\n        o.orden_id,\n        u.usuario_key,\n        t.tiempo_key,\n        d.direccion_key,\n        e.estado_orden_key,\n        o.total              as total_orden,\n        coalesce(da.cantidad_productos, 0) as cantidad_productos\n    from ordenes o\n    left join usuarios_dim u\n        on o.usuario_id = u.usuario_id\n    left join tiempo_dim t\n        on date(o.fecha_orden) = t.fecha\n    left join direccion_dim d\n        on o.usuario_id = d.usuario_id\n    left join estado_dim e\n        on o.estado = e.codigo_estado_orden\n    left join detalle_agg da\n        on o.orden_id = da.orden_id\n\n),\n\ncon_clave as (\n\n    select\n        row_number() over (order by orden_id) as orden_key,\n        orden_id,\n        usuario_key,\n        tiempo_key,\n        direccion_key,\n        estado_orden_key,\n        total_orden,\n        cantidad_productos\n    from joined\n\n)\n\nselect\n    orden_key,\n    orden_id,\n    usuario_key,\n    tiempo_key,\n    direccion_key,\n    estado_orden_key,\n    total_orden,\n    cantidad_productos\nfrom con_clave", "relation_name": "\"EcommerceDB\".\"dbt_marts\".\"f_ordenes\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-26T20:17:52.013431Z", "completed_at": "2025-11-26T20:17:52.048092Z"}, {"name": "execute", "started_at": "2025-11-26T20:17:52.049417Z", "completed_at": "2025-11-26T20:17:52.049438Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.041246652603149414, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_ecommerce.f_detalle_ordenes", "compiled": true, "compiled_code": "with detalle as (\n\n    select\n        detalle_id,\n        orden_id,\n        usuario_id,\n        producto_id,\n        categoria_id,\n        fecha_orden,\n        estado_orden,\n        cantidad,\n        precio_unitario,\n        importe_linea\n    from \"EcommerceDB\".\"dbt_interm\".\"int_detalle_ordenes_enriquecido\"\n\n),\n\nusuarios_dim as (\n\n    select\n        usuario_key,\n        usuario_id\n    from \"EcommerceDB\".\"dbt_marts\".\"d_usuario\"\n\n),\n\nproductos_dim as (\n\n    select\n        producto_key,\n        producto_id,\n        categoria_key\n    from \"EcommerceDB\".\"dbt_marts\".\"d_producto\"\n\n),\n\ntiempo_dim as (\n\n    select\n        tiempo_key,\n        fecha\n    from \"EcommerceDB\".\"dbt_marts\".\"d_tiempo\"\n\n),\n\nestado_dim as (\n\n    select\n        estado_orden_key,\n        codigo_estado_orden\n    from \"EcommerceDB\".\"dbt_marts\".\"d_estado_orden\"\n\n),\n\njoined as (\n\n    select\n        det.detalle_id,\n        det.orden_id,\n        u.usuario_key,\n        p.producto_key,\n        p.categoria_key,\n        t.tiempo_key,\n        e.estado_orden_key,\n        det.cantidad,\n        det.precio_unitario,\n        det.importe_linea\n    from detalle det\n    left join usuarios_dim u\n        on det.usuario_id = u.usuario_id\n    left join productos_dim p\n        on det.producto_id = p.producto_id\n    left join tiempo_dim t\n        on date(det.fecha_orden) = t.fecha\n    left join estado_dim e\n        on det.estado_orden = e.codigo_estado_orden\n\n),\n\ncon_clave as (\n\n    select\n        row_number() over (order by detalle_id) as detalle_orden_key,\n        orden_id,\n        usuario_key,\n        producto_key,\n        categoria_key,\n        tiempo_key,\n        estado_orden_key,\n        cantidad,\n        precio_unitario,\n        importe_linea\n    from joined\n\n)\n\nselect\n    detalle_orden_key,\n    orden_id,\n    usuario_key,\n    producto_key,\n    categoria_key,\n    tiempo_key,\n    estado_orden_key,\n    cantidad,\n    precio_unitario,\n    importe_linea\nfrom con_clave", "relation_name": "\"EcommerceDB\".\"dbt_marts\".\"f_detalle_ordenes\"", "batch_results": null}], "elapsed_time": 0.8971946239471436, "args": {"invocation_command": "dbt docs generate", "require_yaml_configuration_for_mf_time_spines": false, "which": "generate", "log_file_max_bytes": 10485760, "macro_debugging": false, "write_json": true, "version_check": true, "show_resource_report": false, "use_colors": true, "state_modified_compare_more_unrendered_values": false, "partial_parse_file_diff": true, "log_path": "/usr/app/dbt_ecommerce/logs", "quiet": false, "select": [], "profiles_dir": "/usr/app/profiles", "log_level_file": "debug", "warn_error_options": {"include": [], "exclude": []}, "favor_state": false, "state_modified_compare_vars": false, "indirect_selection": "eager", "require_batched_execution_for_custom_microbatch_strategy": false, "empty_catalog": false, "cache_selected_only": false, "introspect": true, "project_dir": "/usr/app/dbt_ecommerce", "print": true, "require_explicit_package_overrides_for_builtin_materializations": true, "send_anonymous_usage_stats": true, "use_colors_file": true, "partial_parse": true, "compile": true, "require_resource_names_without_spaces": false, "require_nested_cumulative_type_params": false, "strict_mode": false, "exclude": [], "static_parser": true, "source_freshness_run_project_hooks": false, "defer": false, "populate_cache": true, "static": false, "log_format": "default", "log_level": "info", "vars": {}, "log_format_file": "debug", "printer_width": 80, "skip_nodes_if_on_run_start_fails": false}}